<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<title>Rinku Book & Stationery - Admin</title>
<style>
body{font-family:Arial;background:#f2f2f2;margin:0;padding:0}
header{background:#1f4bd8;color:#fff;padding:15px;text-align:center;font-size:20px}
.box{max-width:900px;margin:20px auto;background:#fff;padding:20px;border-radius:5px}
input,button,select{width:100%;padding:10px;margin:6px 0;box-sizing:border-box}
button{background:#1f4bd8;color:#fff;border:none;cursor:pointer;border-radius:4px}
button:hover{opacity:0.9}
table{width:100%;border-collapse:collapse;margin-top:15px}
th,td{border:1px solid #ddd;padding:8px;text-align:center}
img{width:60px;object-fit:cover}
.card{border:1px solid #ddd;padding:10px;margin:10px;width:200px;display:inline-block;vertical-align:top;border-radius:5px;background:#fff}
.card img{width:100%;height:150px;object-fit:cover;border-radius:4px}
#preview{width:120px;height:120px;object-fit:cover;margin:5px 0;border:1px solid #ddd;border-radius:4px;display:none;}
#admin,#shop{display:none}
.shop-footer{margin-top:10px;text-align:center;}
.total-price{font-weight:bold;margin-top:5px;}
@media(max-width:600px){
  .card{width:100%;}
}
</style>
</head>
<body>

<header>Rinku Book & Stationery</header>

<!-- LOGIN -->
<div id="login" class="box">
<h3>Admin Login</h3>
<input id="u" placeholder="Username">
<input id="p" type="password" placeholder="Password">
<button onclick="login()">Login</button>
</div>

<!-- ADMIN -->
<div id="admin" class="box">
<h3>Add Product</h3>
<input id="name" placeholder="Product Name">
<input type="file" id="img" onchange="showPreview(event)">
<img id="preview" alt="Image Preview">
<input id="mrp" placeholder="MRP">
<input id="price" placeholder="Price">
<button onclick="save()">Save Product</button>

<h3>Product List</h3>
<table>
<tr>
<th>Name</th><th>Image</th><th>MRP</th><th>Price</th><th>Action</th>
</tr>
<tbody id="list"></tbody>
</table>

<br>
<button onclick="openShop()">View Customer Shop</button>
</div>

<!-- SHOP -->
<div id="shop" class="box">
<h3>Customer Shop</h3>
<div id="shopList"></div>
<div class="shop-footer">
  <p class="total-price">Total Price: ₹<span id="total">0</span></p>
  <button onclick="orderSelected()">Order Selected on WhatsApp</button>
</div>
<br>
<button onclick="back()">Back to Admin</button>
</div>

<script>
const WA="https://wa.me/916294613767?text=";
let items = JSON.parse(localStorage.getItem("items")) || [];

const list = document.getElementById("list");
const admin = document.getElementById("admin");
const shop = document.getElementById("shop");
const shopList = document.getElementById("shopList");
const preview = document.getElementById("preview");
const totalEl = document.getElementById("total");

let tempImage = "";

function login(){
  let u = document.getElementById("u").value;
  let p = document.getElementById("p").value;
  if(u === "admin" && p === "1234"){
    document.getElementById("login").style.display = "none";
    admin.style.display = "block";
    render();
  }else{
    alert("ভুল Username বা Password");
  }
}

function showPreview(event){
  const file = event.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = function(){
      preview.src = reader.result;
      preview.style.display = "block";
      tempImage = reader.result;
    }
    reader.readAsDataURL(file);
  } else {
    preview.style.display = "none";
    tempImage = "";
  }
}

function save(){
  let n = document.getElementById("name").value.trim();
  let m = document.getElementById("mrp").value.trim();
  let p = document.getElementById("price").value.trim();

  if(n === "" || m === "" || p === "" || tempImage === ""){
    alert("সব ফিল্ড পূরণ করুন এবং ছবি যোগ করুন");
    return;
  }

  items.push({n:n, m:m, p:p, i:tempImage});
  localStorage.setItem("items",JSON.stringify(items));
  render();

  document.getElementById("name").value="";
  document.getElementById("mrp").value="";
  document.getElementById("price").value="";
  document.getElementById("img").value="";
  preview.style.display="none";
  tempImage="";
}

function render(){
  list.innerHTML="";
  items.forEach((x,i)=>{
    let tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${x.n}</td>
      <td><img src="${x.i}"></td>
      <td>₹${x.m}</td>
      <td><b>₹${x.p}</b></td>
      <td><button>Delete</button></td>
    `;
    tr.querySelector("button").addEventListener("click", ()=>{
      if(confirm(`আপনি কি '${x.n}' প্রোডাক্টটি মুছে ফেলতে চান?`)){
        items.splice(i,1);
        localStorage.setItem("items",JSON.stringify(items));
        render();
      }
    });
    list.appendChild(tr);
  });
}

// Customer Shop
function openShop(){
  admin.style.display="none";
  shop.style.display="block";
  shopList.innerHTML="";
  items.forEach((p,i)=>{
    let div = document.createElement("div");
    div.className="card";
    div.innerHTML = `
      <input type="checkbox" id="check${i}" onchange="updateTotal()">
      <img src="${p.i}">
      <h4>${p.n}</h4>
      <p><del>₹${p.m}</del> <b>₹${p.p}</b></p>
      <label>Quantity:
        <select id="qty${i}" onchange="updateTotal()">
          ${[...Array(10).keys()].map(n=>`<option value="${n+1}">${n+1}</option>`).join('')}
        </select>
      </label>
    `;
    shopList.appendChild(div);
  });
  updateTotal();
}

function updateTotal(){
  let total = 0;
  items.forEach((p,i)=>{
    let cb = document.getElementById("check"+i);
    let qty = document.getElementById("qty"+i);
    if(cb && cb.checked && qty){
      total += parseInt(p.p) * parseInt(qty.value);
    }
  });
  totalEl.textContent = total;
}

function orderSelected(){
  let msg = "Order:%0A";
  let anySelected = false;
  items.forEach((p,i)=>{
    let cb = document.getElementById("check"+i);
    let qty = document.getElementById("qty"+i);
    if(cb && cb.checked && qty){
      msg += `${p.n} x ${qty.value} - ₹${parseInt(p.p)*parseInt(qty.value)}%0A`;
      anySelected = true;
    }
  });
  if(!anySelected){
    alert("অর্ডার করার জন্য কমপক্ষে একটি প্রোডাক্ট সিলেক্ট করুন");
    return;
  }
  msg += `Total Price: ₹${totalEl.textContent}`;
  window.open(WA + msg, "_blank");
}

function back(){
  shop.style.display="none";
  admin.style.display="block";
}
</script>

</body>
</html>
